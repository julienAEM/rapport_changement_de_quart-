<script>
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxaGBM2UyvLY0cFXJkzYpFsJpXi2uGuzhFi7n6N5SwWrLkxWFWbYKkOe7lDPIQzyoTf0A/exec';

  // ENVOI (POST) vers la feuille cible
  function sendToHub(payload, SHEET_KEY) {
    const body = Object.assign({_sheet: SHEET_KEY}, payload);
    return fetch(ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    }).then(r => r.json());
  }

  // LECTURE (GET) d’une feuille précise
  function fetchFromHub(SHEET_KEY) {
    return fetch(`${ENDPOINT}?sheet=${encodeURIComponent(SHEET_KEY)}`)
      .then(r => r.json());
  }
</script>
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Recherche de rapports</title>
<style>
  :root {
    --primary-color: #253746;
    --secondary-color: #324e67;
    --accent-color: #0078C8;
    --text-light: #ffffff;
    --field-bg: #f5f5f5;
  }
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: var(--primary-color); color: var(--text-light); }
  .wrapper { max-width: 1000px; margin: 2rem auto; background: var(--secondary-color); border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); overflow: hidden; }
  .header { background: var(--primary-color); padding: 1rem 2rem; display: flex; align-items: center; border-bottom: 3px solid var(--accent-color); }
  .header img { height: 50px; margin-right: 1rem; }
  .header h1 { font-size: 1.5rem; margin: 0; color: var(--text-light); }
  .nav-buttons { display: flex; justify-content: center; gap: 1rem; margin: 1rem; }
  .nav-button { display: inline-block; padding: 0.7rem 1.4rem; background: var(--accent-color); color: var(--text-light); border-radius: 4px; text-decoration: none; font-size: 1rem; }
  .nav-button:hover { background: #005fa0; }
  .content { padding: 2rem; }
  form { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
  label { display: block; margin-bottom: 0.3rem; font-weight: bold; }
  input[type="date"], select, input[type="text"] { width: 100%; padding: 0.6rem; border: 1px solid #ccc; border-radius: 4px; background: var(--field-bg); color: #333; box-sizing: border-box; }
  table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
  th, td { border: 1px solid #ddd; padding: 0.6rem; text-align: left; }
  th { background: var(--accent-color); color: var(--text-light); }
  .no-results { text-align: center; padding: 1rem; }
</style>
</head>
<body>
<div class="wrapper">
  <div class="header">
    <img src="https://aemhpa.com/hs-fs/hubfs/AEM%20Logo%20(with%20name%20in%20white%20right)%201.png?width=226&height=64&name=AEM%20Logo%20(with%20name%20in%20white%20right)%201.png" alt="Logo AEM">
    <h1>Recherche de rapports</h1>
  </div>
<div class="link-buttons">
  <a class="link-button" href="index.html">Retour vers Accueil</a>
  <a class="link-button" href="rapport_multi_search.html">Consulter les rapports</a>
</div>
  <div class="content">
    <form id="searchForm">
      <div>
        <label for="date_debut">Date début :</label>
        <input type="date" id="date_debut" name="date_debut">
      </div>
      <div>
        <label for="date_fin">Date fin :</label>
        <input type="date" id="date_fin" name="date_fin">
      </div>
      <div>
        <label for="equipe">Équipe :</label>
        <select id="equipe" name="equipe">
          <option value="">--Toutes--</option>
                <option value="Opération David Noel 418-629-7670">Opération David Noel 418-629-7670</option>
                <option value="Opération Simon Beaulieu 514-503-2750">Opération Simon Beaulieu 514-503-2750</option>
        </select>
      </div>
      <div>
        <label for="employe">Employé :</label>
        <select id="employe" name="employe">
          <option value="">--Tous--</option>
                <option value="Alexandre Dulude">Alexandre Dulude</option>
                <option value="Benoit Anctil">Benoit Anctil</option>
                <option value="Danik Deschênes">Danik Deschênes</option>
                <option value="David Michaud">David Michaud</option>
                <option value="Denis Letourneau">Denis Letourneau</option>
                <option value="Emrick Miousse">Emrick Miousse</option>
                <option value="Erik Dugas">Erik Dugas</option>
                <option value="Eugene Barriault">Eugene Barriault</option>
                <option value="Jean-Christophe Vallée">Jean-Christophe Vallée</option>
                <option value="Jean-Francois Savard">Jean-Francois Savard</option>
                <option value="Julien Deschênes">Julien Deschênes</option>
                <option value="Jérémie Barriault">Jérémie Barriault</option>
                <option value="Linka Pelletier">Linka Pelletier</option>
                <option value="Mathieu Sergerie">Mathieu Sergerie</option>
                <option value="Maxime Therrien-Dugas">Maxime Therrien-Dugas</option>
                <option value="Mickael Roy">Mickael Roy</option>
                <option value="Olivier Chrétien">Olivier Chrétien</option>
                <option value="Pierre-Luc Desrosiers">Pierre-Luc Desrosiers</option>
                <option value="Raymond Émond">Raymond Émond</option>
                <option value="Sammuel Bapeneck">Sammuel Bapeneck</option>
                <option value="Samuel Boucher">Samuel Boucher</option>
                <option value="Samuel Fortin">Samuel Fortin</option>
                <option value="Serge Landry">Serge Landry</option>
                <option value="Simon Synnett">Simon Synnett</option>
                <option value="Stéphane Dugas">Stéphane Dugas</option>
                <option value="Sébastien Therrien">Sébastien Therrien</option>
                <option value="Vincent Morin">Vincent Morin</option>
                <option value="Yannick Servais">Yannick Servais</option>
                <option value="Yousri Askri">Yousri Askri</option>
                <option value="Éric-Hugo Bastien">Éric-Hugo Bastien</option>
                <option value="Étienne Picard">Étienne Picard</option>
        </select>
      </div>
      <div>
        <label for="categorie">Catégorie :</label>
        <select id="categorie" name="categorie">
          <option value="">--Toutes--</option>
                <option value="Digestion">Digestion</option>
                <option value="Cristalisation">Cristalisation</option>
                <option value="Centrifuge">Centrifuge</option>
                <option value="Décomposition (Harpers)">Décomposition (Harpers)</option>
                <option value="Calcination (F04)">Calcination (F04)</option>
                <option value="Lavage S02">Lavage S02</option>
                <option value="Buhler">Buhler</option>
                <option value="HP60 (Mega Pulse)">HP60 (Mega Pulse)</option>
                <option value="Mini-Pulse">Mini-Pulse</option>
                <option value="Fabrication de Puck">Fabrication de Puck</option>
                <option value="Traitement des eaux">Traitement des eaux</option>
                <option value="Varia">Varia</option>
        </select>
      </div>
      <div>
        <label for="statut">Statut :</label>
        <select id="statut" name="statut">
          <option value="">--Tous--</option>
                <option value="À l'arrêt">À l'arrêt</option>
                <option value="En continu">En continu</option>
                <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
                <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
                <option value="À respecter">À respecter</option>
                <option value="En cours">En cours</option>
                <option value="À faire">À faire</option>
                <option value="Fait">Fait</option>
                <option value="Important">Important</option>
                <option value="Très important">Très important</option>
                <option value="Prioritaire">Prioritaire</option>
                <option value="Si possible">Si possible</option>
                <option value="Stand-by">Stand-by</option>
                <option value="Annulé">Annulé</option>
                <option value="Remis">Remis</option>
                <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div style="grid-column: span 2;">
        <label for="texte">Recherche texte :</label>
        <input type="text" id="texte" name="texte">
      </div>
      <div style="grid-column: span 2; text-align: right;">
        <button type="submit" style="padding: 0.7rem 1.4rem; background: var(--accent-color); color: var(--text-light); border: none; border-radius: 4px; cursor: pointer;">Rechercher</button>
      </div>
    </form>

    <table id="resultsTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Équipe</th>
          <th>Catégorie</th>
          <th>Statut</th>
          <th>Résumé</th>
        </tr>
      </thead>
      <tbody>
        <tr class="no-results">
          <td colspan="5">Aucun résultat pour le moment.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
</body>
</html>
