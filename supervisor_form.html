<script>
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxaGBM2UyvLY0cFXJkzYpFsJpXi2uGuzhFi7n6N5SwWrLkxWFWbYKkOe7lDPIQzyoTf0A/exec';

  // ENVOI (POST) vers la feuille cible
  function sendToHub(payload, SHEET_KEY) {
    const body = Object.assign({_sheet: SHEET_KEY}, payload);
    return fetch(ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    }).then(r => r.json());
  }

  // LECTURE (GET) d’une feuille précise
  function fetchFromHub(SHEET_KEY) {
    return fetch(`${ENDPOINT}?sheet=${encodeURIComponent(SHEET_KEY)}`)
      .then(r => r.json());
  }
</script>
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Rapport fin de rotation (superviseur)</title>
<style>
  :root {
    --primary-color: #253746;
    --secondary-color: #324e67;
    --accent-color: #0078C8;
    --text-light: #ffffff;
    --field-bg: #f5f5f5;
    --section-bg-blue: #1f3a5f;
  }
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: var(--primary-color); color: var(--text-light); }
  .form-wrapper { max-width: 1000px; margin: 2rem auto; background: var(--secondary-color); border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); overflow: hidden; }
  .form-header { background: var(--primary-color); padding: 1rem 2rem; display: flex; align-items: center; border-bottom: 3px solid var(--accent-color); }
  .form-header img { height: 50px; margin-right: 1rem; }
  .form-header h1 { font-size: 1.5rem; color: var(--text-light); margin: 0; }
  .link-buttons { display: flex; justify-content: center; gap: 1rem; margin-bottom: 1rem; }
  .link-button { display: inline-block; padding: 0.7rem 1.4rem; background: var(--accent-color); color: var(--text-light); border-radius: 4px; text-decoration: none; font-size: 1rem; }
  .link-button:hover { background: #005fa0; }
  .form-content { padding: 2rem; }
  label { display: block; margin-top: 0.8rem; font-weight: bold; color: var(--text-light); }
  input[type="text"], textarea, select { width: 100%; padding: 0.6rem; margin-top: 0.2rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; box-sizing: border-box; background: var(--field-bg); color: #333; }
  textarea { resize: vertical; min-height: 60px; }
  .category-section { margin-top: 1.5rem; padding: 1rem; background: var(--section-bg-blue); border-radius: 4px; }
  .category-section h3 { margin-top: 0; margin-bottom: 0.5rem; color: var(--accent-color); }
  @media print {
    button { display: none; }
    .link-buttons { display: none; }
  }
<button type="button" onclick="saveReport()">Enregistrer</button>
</style>
</head>
<body>
<div class="form-wrapper">
  <div class="form-header">
    <img src="https://aemhpa.com/hs-fs/hubfs/AEM%20Logo%20(with%20name%20in%20white%20right)%201.png?width=226&height=64&name=AEM%20Logo%20(with%20name%20in%20white%20right)%201.png" alt="Logo AEM">
    <h1>Rapport fin de rotation (superviseur)</h1>
  </div>
  <div class="link-buttons">
  <a class="link-button" href="index.html">Retour vers Accueil</a>
  <a class="link-button" href="rapport_multi_search.html">Consulter les rapports</a>
  </div>
  <div class="form-content">
    <form id="supervisorForm">
      
      <label for="superviseur">Superviseur :</label>
      <select id="superviseur" name="superviseur">
        <option value="">--Sélectionnez--</option>
        <option value="Vincent Lévesque">Vincent Lévesque</option>
        <option value="Olivier Chrétien">Olivier Chrétien</option>
      </select>

      <!-- Summary fields similar to main form -->
      <label for="sante">Santé / Sécurité :</label>
      <textarea id="sante" name="sante"></textarea>

      <label for="environnement">Environnement :</label>
      <textarea id="environnement" name="environnement"></textarea>

      <label for="production">Production (tonnage par client) :</label>
      <textarea id="production" name="production"></textarea>

      <label for="resume">Résumé de la rotation :</label>
      <textarea id="resume" name="resume"></textarea>

      <!-- Category sections -->
      
      <div class="category-section">
        <h3>Digestion</h3>
        <label for="digestion_consigne">Consigne :</label>
        <textarea id="digestion_consigne" name="digestion_consigne"></textarea>

        <label for="digestion_statut">Statut :</label>
        <select id="digestion_statut" name="digestion_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Cristalisation</h3>
        <label for="cristalisation_consigne">Consigne :</label>
        <textarea id="cristalisation_consigne" name="cristalisation_consigne"></textarea>

        <label for="cristalisation_statut">Statut :</label>
        <select id="cristalisation_statut" name="cristalisation_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Centrifuge</h3>
        <label for="centrifuge_consigne">Consigne :</label>
        <textarea id="centrifuge_consigne" name="centrifuge_consigne"></textarea>

        <label for="centrifuge_statut">Statut :</label>
        <select id="centrifuge_statut" name="centrifuge_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Décomposition (Harpers)</h3>
        <label for="décomposition_harpers_consigne">Consigne :</label>
        <textarea id="décomposition_harpers_consigne" name="décomposition_harpers_consigne"></textarea>

        <label for="décomposition_harpers_statut">Statut :</label>
        <select id="décomposition_harpers_statut" name="décomposition_harpers_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Calcination (F04)</h3>
        <label for="calcination_f04_consigne">Consigne :</label>
        <textarea id="calcination_f04_consigne" name="calcination_f04_consigne"></textarea>

        <label for="calcination_f04_statut">Statut :</label>
        <select id="calcination_f04_statut" name="calcination_f04_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Lavage S02</h3>
        <label for="lavage_s02_consigne">Consigne :</label>
        <textarea id="lavage_s02_consigne" name="lavage_s02_consigne"></textarea>

        <label for="lavage_s02_statut">Statut :</label>
        <select id="lavage_s02_statut" name="lavage_s02_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Buhler</h3>
        <label for="buhler_consigne">Consigne :</label>
        <textarea id="buhler_consigne" name="buhler_consigne"></textarea>

        <label for="buhler_statut">Statut :</label>
        <select id="buhler_statut" name="buhler_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>HP60 (Mega Pulse)</h3>
        <label for="hp60_mega_pulse_consigne">Consigne :</label>
        <textarea id="hp60_mega_pulse_consigne" name="hp60_mega_pulse_consigne"></textarea>

        <label for="hp60_mega_pulse_statut">Statut :</label>
        <select id="hp60_mega_pulse_statut" name="hp60_mega_pulse_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Mini-Pulse</h3>
        <label for="mini_pulse_consigne">Consigne :</label>
        <textarea id="mini_pulse_consigne" name="mini_pulse_consigne"></textarea>

        <label for="mini_pulse_statut">Statut :</label>
        <select id="mini_pulse_statut" name="mini_pulse_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Fabrication de Puck</h3>
        <label for="fabrication_de_puck_consigne">Consigne :</label>
        <textarea id="fabrication_de_puck_consigne" name="fabrication_de_puck_consigne"></textarea>

        <label for="fabrication_de_puck_statut">Statut :</label>
        <select id="fabrication_de_puck_statut" name="fabrication_de_puck_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Traitement des eaux</h3>
        <label for="traitement_des_eaux_consigne">Consigne :</label>
        <textarea id="traitement_des_eaux_consigne" name="traitement_des_eaux_consigne"></textarea>

        <label for="traitement_des_eaux_statut">Statut :</label>
        <select id="traitement_des_eaux_statut" name="traitement_des_eaux_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>
      <div class="category-section">
        <h3>Varia</h3>
        <label for="varia_consigne">Consigne :</label>
        <textarea id="varia_consigne" name="varia_consigne"></textarea>

        <label for="varia_statut">Statut :</label>
        <select id="varia_statut" name="varia_statut">
          <option value="">--Sélectionnez le statut--</option>
            <option value="À l'arrêt">À l'arrêt</option>
            <option value="En continu">En continu</option>
            <option value="À partir 1 fois par shift">À partir 1 fois par shift</option>
            <option value="À partir 1 fois par jour">À partir 1 fois par jour</option>
            <option value="À respecter">À respecter</option>
            <option value="En cours">En cours</option>
            <option value="À faire">À faire</option>
            <option value="Fait">Fait</option>
            <option value="Important">Important</option>
            <option value="Très important">Très important</option>
            <option value="Prioritaire">Prioritaire</option>
            <option value="Si possible">Si possible</option>
            <option value="Stand-by">Stand-by</option>
            <option value="Annulé">Annulé</option>
            <option value="Remis">Remis</option>
            <option value="Au besoin">Au besoin</option>
        </select>
      </div>

      <button type="submit">Envoyer</button>
      <button type="button" onclick="window.print()">Imprimer</button>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const dateInput = document.getElementById('date_du_jour');
  if (dateInput) {
    const today = new Date().toISOString().substr(0, 10);
    dateInput.value = today;
  }
});
  <script>
function populateSelect(id, key, defaults) {
  const select = document.getElementById(id);
  let list = [];
  try { list = (localStorage.getItem(key) || '').split(/\n|;/).map(s => s.trim()).filter(Boolean); } catch(e){}
  const items = list.length ? list : (defaults || []);
  select.innerHTML = '<option value="">--Sélectionnez--</option>';
  items.forEach(v => {
    const opt = document.createElement('option');
    opt.value = v; opt.textContent = v;
    select.appendChild(opt);
  });
}
document.addEventListener('DOMContentLoaded', () => {
  populateSelect('superviseur','supervisorList',['Vincent Lévesque','Olivier Chrétien']);
});
</script>
<script>
function collectSupervisorReport() {
  const superviseur = document.getElementById('superviseur').value;
  const sante       = document.getElementById('sante').value;
  const env         = document.getElementById('environnement').value;
  const production  = document.getElementById('production').value;
  const resume      = document.getElementById('resume').value;
  // Ajoute ici les sections/catégories si tu veux les structurer
  return { superviseur, sante, environnement: env, production, resume };
}
function saveReport() {
  const report = collectSupervisorReport();
  report._sheet = 'RapportFinRotationSuperviseur';
  try {
    const arr = JSON.parse(localStorage.getItem('rotationsSuperviseur') || '[]');
    arr.push(report);
    localStorage.setItem('rotationsSuperviseur', JSON.stringify(arr));
    fetch(ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(report)
    })
    .then(() => alert('Rapport enregistré.'))
    .catch(err => { console.error(err); alert('Erreur lors de l’envoi.'); });
  } catch (e) {
    console.error(e); alert('Erreur locale.');
  }
}
</script>
</body>
</html>
